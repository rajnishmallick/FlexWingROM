function [xi, eta] = QUAD_global2localCS(xVertices, yVertices, x, y)
% xVertices and yVertices have to be COLUMN vectors
% x and y have to be COLUMN vectors
%
% http://xenia.media.mit.edu/~cwren/interpolator/

% x1 = xVertices(1);
% x2 = xVertices(2);
% x3 = xVertices(3);
% x4 = xVertices(4);
% 
% y1 = yVertices(1);
% y2 = yVertices(2);
% y3 = yVertices(3);
% y4 = yVertices(4);

% figure
% hold all
% plot(xVertices([1:end 1]), yVertices([1:end 1]));
% for i = 1:4
% 	text(xVertices(i), yVertices(i), num2str(i));
% end
% plot(x, y, 'o')

%{
UNSTABLE METHOD

% eta = -(sqrt(x.^2.*(y1-y2+y3-y4).^2-2.*x.*(y.*(x1-x2+x3-x4).*(y1-y2+y3-y4)-x1.*(y1.*y3+y2.*(y3-2.*y4)-y3.*(y3-y4))+x2.*(y1.*(2.*y3-y4)-y4.*(y2+y3-y4))+x3.*(y1.^2-y1.*(y2+y3+y4)+2.*y2.*y4)+x4.*(y2.*(y2-y3-y4)-y1.*(y2-2.*y3)))+y.^2.*(x1-x2+x3-x4).^2-2.*y.*(x1.^2.*y3-x1.*(x2.*(y3+y4)+x3.*(y1-2.*y2+y3-2.*y4)+x4.*(y2+y3))+x2.^2.*y4+x2.*(x4.*(2.*y1-y2+2.*y3-y4)-x3.*(y1+y4))+(x3-x4).*(x3.*y1-x4.*y2))+x1.^2.*y3.^2-2.*x1.*(x2.*y3.*y4+x3.*(y1.*y3-2.*y2.*y4)+x4.*y2.*y3)+x2.^2.*y4.^2-2.*x2.*(x3.*y1.*y4+x4.*(y2.*y4-2.*y1.*y3))+x3.^2.*y1.^2-2.*x3.*x4.*y1.*y2+x4.^2.*y2.^2)-x.*(y1-y2+y3-y4)+y.*(x1-x2+x3-x4)-x1.*y2+x2.*y1-x3.*y4+x4.*y3)./(x1.*(y2-y3)+x2.*(y4-y1)+x3.*(y1-y4)+x4.*(y3-y2));
% xi = -(sqrt(x.^2.*(y1-y2+y3-y4).^2-2.*x.*(y.*(x1-x2+x3-x4).*(y1-y2+y3-y4)-x1.*(y1.*y3+y2.*(y3-2.*y4)-y3.*(y3-y4))+x2.*(y1.*(2.*y3-y4)-y4.*(y2+y3-y4))+x3.*(y1.^2-y1.*(y2+y3+y4)+2.*y2.*y4)+x4.*(y2.*(y2-y3-y4)-y1.*(y2-2.*y3)))+y.^2.*(x1-x2+x3-x4).^2-2.*y.*(x1.^2.*y3-x1.*(x2.*(y3+y4)+x3.*(y1-2.*y2+y3-2.*y4)+x4.*(y2+y3))+x2.^2.*y4+x2.*(x4.*(2.*y1-y2+2.*y3-y4)-x3.*(y1+y4))+(x3-x4).*(x3.*y1-x4.*y2))+x1.^2.*y3.^2-2.*x1.*(x2.*y3.*y4+x3.*(y1.*y3-2.*y2.*y4)+x4.*y2.*y3)+x2.^2.*y4.^2-2.*x2.*(x3.*y1.*y4+x4.*(y2.*y4-2.*y1.*y3))+x3.^2.*y1.^2-2.*x3.*x4.*y1.*y2+x4.^2.*y2.^2)+x.*(y1-y2+y3-y4)-y.*(x1-x2+x3-x4)+x1.*y4-x2.*y3+x3.*y2-x4.*y1)./(x1.*(y3-y4)+x2.*(y4-y3)+(x3-x4).*(y2-y1));

% eta = (sqrt(x.^2.*(y1-y2+y3-y4).^2-2.*x.*(y.*(x1-x2+x3-x4).*(y1-y2+y3-y4)-x1.*(y1.*y3+y2.*(y3-2.*y4)-y3.*(y3-y4))+x2.*(y1.*(2.*y3-y4)-y4.*(y2+y3-y4))+x3.*(y1.^2-y1.*(y2+y3+y4)+2.*y2.*y4)+x4.*(y2.*(y2-y3-y4)-y1.*(y2-2.*y3)))+y.^2.*(x1-x2+x3-x4).^2-2.*y.*(x1.^2.*y3-x1.*(x2.*(y3+y4)+x3.*(y1-2.*y2+y3-2.*y4)+x4.*(y2+y3))+x2.^2.*y4+x2.*(x4.*(2.*y1-y2+2.*y3-y4)-x3.*(y1+y4))+(x3-x4).*(x3.*y1-x4.*y2))+x1.^2.*y3.^2-2.*x1.*(x2.*y3.*y4+x3.*(y1.*y3-2.*y2.*y4)+x4.*y2.*y3)+x2.^2.*y4.^2-2.*x2.*(x3.*y1.*y4+x4.*(y2.*y4-2.*y1.*y3))+x3.^2.*y1.^2-2.*x3.*x4.*y1.*y2+x4.^2.*y2.^2)+x.*(y1-y2+y3-y4)-y.*(x1-x2+x3-x4)+x1.*y2-x2.*y1+x3.*y4-x4.*y3)./(x1.*(y2-y3)+x2.*(y4-y1)+x3.*(y1-y4)+x4.*(y3-y2));
% xi = (sqrt(x.^2.*(y1-y2+y3-y4).^2-2.*x.*(y.*(x1-x2+x3-x4).*(y1-y2+y3-y4)-x1.*(y1.*y3+y2.*(y3-2.*y4)-y3.*(y3-y4))+x2.*(y1.*(2.*y3-y4)-y4.*(y2+y3-y4))+x3.*(y1.^2-y1.*(y2+y3+y4)+2.*y2.*y4)+x4.*(y2.*(y2-y3-y4)-y1.*(y2-2.*y3)))+y.^2.*(x1-x2+x3-x4).^2-2.*y.*(x1.^2.*y3-x1.*(x2.*(y3+y4)+x3.*(y1-2.*y2+y3-2.*y4)+x4.*(y2+y3))+x2.^2.*y4+x2.*(x4.*(2.*y1-y2+2.*y3-y4)-x3.*(y1+y4))+(x3-x4).*(x3.*y1-x4.*y2))+x1.^2.*y3.^2-2.*x1.*(x2.*y3.*y4+x3.*(y1.*y3-2.*y2.*y4)+x4.*y2.*y3)+x2.^2.*y4.^2-2.*x2.*(x3.*y1.*y4+x4.*(y2.*y4-2.*y1.*y3))+x3.^2.*y1.^2-2.*x3.*x4.*y1.*y2+x4.^2.*y2.^2)-x.*(y1-y2+y3-y4)+y.*(x1-x2+x3-x4)-x1.*y4+x2.*y3-x3.*y2+x4.*y1)./(x1.*(y3-y4)+x2.*(y4-y3)+(x3-x4).*(y2-y1));

% xi1 = (2*x*y1 - 2*x1*y - 2*x*y2 + 2*x2*y + 2*x*y3 - 2*x3*y - 2*x*y4 + 2*x4*y + x1*y2 - x2*y1 + x1*y4 - x2*y3 + x3*y2 - x4*y1 + x3*y4 - x4*y3 + (x1*y3*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x3*y1*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x1*y4*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x2*y3*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x3*y2*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x4*y1*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x2*y4*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x4*y2*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2))/(x1*y2 - x2*y1 - x1*y3 + x3*y1 + x2*y4 - x4*y2 - x3*y4 + x4*y3);
% xi2 = (2*x*y1 - 2*x1*y - 2*x*y2 + 2*x2*y + 2*x*y3 - 2*x3*y - 2*x*y4 + 2*x4*y + x1*y2 - x2*y1 + x1*y4 - x2*y3 + x3*y2 - x4*y1 + x3*y4 - x4*y3 - (x1*y3*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x3*y1*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x1*y4*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x2*y3*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x3*y2*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x4*y1*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) - (x2*y4*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2) + (x4*y2*((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1))/(x1*y3 - x3*y1 - x1*y4 - x2*y3 + x3*y2 + x4*y1 + x2*y4 - x4*y2))/(x1*y2 - x2*y1 - x1*y3 + x3*y1 + x2*y4 - x4*y2 - x3*y4 + x4*y3);

% xi1 = ((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y2 - x2*y1 + x3*y4 - x4*y3)/(x1*y2 - x2*y1 - x1*y3 + x3*y1 + y4*(x2 - x3) - x4*(y2 - y3));
% xi2 = -((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y2 + x2*y1 - x3*y4 + x4*y3)/(x1*y2 - x2*y1 - x1*y3 + x3*y1 + y4*(x2 - x3) - x4*(y2 - y3));

% eta1 = ((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) - x*y1 + x1*y + x*y2 - x2*y - x*y3 + x3*y + x*y4 - x4*y - x1*y4 + x2*y3 - x3*y2 + x4*y1)/(y3*(x1 - x2) - y4*(x1 - x2) - x3*(y1 - y2) + x4*(y1 - y2));
% eta2 = -((x^2*y1^2 - 2*x^2*y1*y2 + 2*x^2*y1*y3 - 2*x^2*y1*y4 + x^2*y2^2 - 2*x^2*y2*y3 + 2*x^2*y2*y4 + x^2*y3^2 - 2*x^2*y3*y4 + x^2*y4^2 - 2*x*x1*y*y1 + 2*x*x1*y*y2 - 2*x*x1*y*y3 + 2*x*x1*y*y4 + 2*x*x1*y1*y3 + 2*x*x1*y2*y3 - 4*x*x1*y2*y4 - 2*x*x1*y3^2 + 2*x*x1*y3*y4 + 2*x*x2*y*y1 - 2*x*x2*y*y2 + 2*x*x2*y*y3 - 2*x*x2*y*y4 - 4*x*x2*y1*y3 + 2*x*x2*y1*y4 + 2*x*x2*y2*y4 + 2*x*x2*y3*y4 - 2*x*x2*y4^2 - 2*x*x3*y*y1 + 2*x*x3*y*y2 - 2*x*x3*y*y3 + 2*x*x3*y*y4 - 2*x*x3*y1^2 + 2*x*x3*y1*y2 + 2*x*x3*y1*y3 + 2*x*x3*y1*y4 - 4*x*x3*y2*y4 + 2*x*x4*y*y1 - 2*x*x4*y*y2 + 2*x*x4*y*y3 - 2*x*x4*y*y4 + 2*x*x4*y1*y2 - 4*x*x4*y1*y3 - 2*x*x4*y2^2 + 2*x*x4*y2*y3 + 2*x*x4*y2*y4 + x1^2*y^2 - 2*x1^2*y*y3 + x1^2*y3^2 - 2*x1*x2*y^2 + 2*x1*x2*y*y3 + 2*x1*x2*y*y4 - 2*x1*x2*y3*y4 + 2*x1*x3*y^2 + 2*x1*x3*y*y1 - 4*x1*x3*y*y2 + 2*x1*x3*y*y3 - 4*x1*x3*y*y4 - 2*x1*x3*y1*y3 + 4*x1*x3*y2*y4 - 2*x1*x4*y^2 + 2*x1*x4*y*y2 + 2*x1*x4*y*y3 - 2*x1*x4*y2*y3 + x2^2*y^2 - 2*x2^2*y*y4 + x2^2*y4^2 - 2*x2*x3*y^2 + 2*x2*x3*y*y1 + 2*x2*x3*y*y4 - 2*x2*x3*y1*y4 + 2*x2*x4*y^2 - 4*x2*x4*y*y1 + 2*x2*x4*y*y2 - 4*x2*x4*y*y3 + 2*x2*x4*y*y4 + 4*x2*x4*y1*y3 - 2*x2*x4*y2*y4 + x3^2*y^2 - 2*x3^2*y*y1 + x3^2*y1^2 - 2*x3*x4*y^2 + 2*x3*x4*y*y1 + 2*x3*x4*y*y2 - 2*x3*x4*y1*y2 + x4^2*y^2 - 2*x4^2*y*y2 + x4^2*y2^2)^(1/2) + x*y1 - x1*y - x*y2 + x2*y + x*y3 - x3*y - x*y4 + x4*y + x1*y4 - x2*y3 + x3*y2 - x4*y1)/(y3*(x1 - x2) - y4*(x1 - x2) - x3*(y1 - y2) + x4*(y1 - y2));
%}

%{
Xp=[-1;  1;  1; -1];
Yp=[-1; -1;  1;  1];
B = [ xVertices yVertices ones(size(xVertices)) zeros(4,3)        -xVertices.*Xp -yVertices.*Xp ...
	zeros(4,3)        xVertices yVertices ones(size(xVertices)) -xVertices.*Yp -yVertices.*Yp ];
B = reshape (B', 8 , 8 )';
D = [ Xp , Yp ];
D = reshape (D', 8 , 1 );
% l = inv(B' * B) * B' * D;
l = (B' * B) \ B' * D;
A = reshape([l(1:6)' 0 0 1 ],3,3)';
C = [l(7:8)' 1];

t = A*[x';y';ones(size(x'))]./repmat((C*[x';y';ones(size(x'))]), 3, 1);

xi = t(1,:)';
eta = t(2,:)';
%}


% WORKS ONLY IF THE NUMBERING OF THE NODES IS COUNTERCLOCKWISE

x1 = xVertices(1);
x2 = xVertices(2);
x3 = xVertices(3);
x4 = xVertices(4);

y1 = yVertices(1);
y2 = yVertices(2);
y3 = yVertices(3);
y4 = yVertices(4);

xb=x1-x2+x3-x4;
yb=y1-y2+y3-y4;
xc_xi=x1+x2-x3-x4;
yc_xi=y1+y2-y3-y4;
xc_eta=x1-x2-x3+x4;
yc_eta=y1-y2-y3+y4;
x0=(x1+x2+x3+x4)/4;
y0=(y1+y2+y3+y4)/4;

J0=(x3-x1)*(y4-y2)-(x4-x2)*(y3-y1);
A=J0/2;
J1=(x3-x4)*(y1-y2)-(x1-x2)*(y3-y4);
J2=(x2-x3)*(y1-y4)-(x1-x4)*(y2-y3);
dx=x-x0;
dy=y-y0;
b_xi=A-dx*yb+dy*xb;
b_eta=-A-dx*yb+dy*xb;
c_xi= dx*yc_xi-dy*xc_xi;
c_eta=dx*yc_eta-dy*xc_eta;
xi=2*c_xi./(-sqrt(b_xi.^2-2*J1*c_xi)-b_xi);
eta=2*c_eta./( sqrt(b_eta.^2+2*J2*c_eta)-b_eta);

% figure
% plot(xi, eta, '.')
end