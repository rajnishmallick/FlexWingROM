---
title: 'FlexWing-ROM: A matlab framework for data-driven reduced-order modeling of flexible wings'
tags:
  - Matlab
  - data-driven modeling
  - aeroelasticity
  - morphing wings
  - dynamic mode decomposition with control
authors:
  - name: Urban Fasel
    affiliation: 1
  - name: Nicola Fonzi
    affiliation: 2
  - name: Andrea Iannelli
    affiliation: 3
  - name: Steven L. Brunton
    affiliation: 4
affiliations:
 - name: Department of Aeronautics, Imperial College, London, United Kingdom
   index: 1
 - name: Department of Aerospace Science and Technology, Politecnico di Milano, Milan, Italy
   index: 2
 - name: Department of Information Technology and Electrical Engineering, ETH Zurich, Zurich, Switzerland
   index: 3
 - name: Department of Mechanical Engineering, University of Washington, Seattle, United States of America
   index: 4
date: 27 January 2022
bibliography: paper.bib

---

# Summary

Flexible wings pose a considerable modeling challenge, as they involve highly coupled and nonlinear interactions between the aerodynamic and structural dynamics. 
In this work, we provide an open source code framework, unifying recent data-driven modeling methods that extend the dynamic mode decomposition with control (DMDc) to model the nonlinear aeroelasticity of flexible wings. 
Our framework consists of (1) a fully parametrized flexible wing model; (2) a fluid-structure interaction (FSI) solver that couples a detailed finite element model of the wing structure with a 3D unsteady aerodynamic panel method; and (3) three different data-driven reduced-order aeroelastic modeling methods. 
We demonstrate our framework on two flexible wings and provide tutorials to compare the different data-driven methods. 
The code is widely applicable and useful for generating accurate and efficient data-driven reduced-order models, and it provides a benchmark for future developments of aeroelastic reduced-order modeling methods.

# Statement of need


Accurate and efficient aeroelastic models are critically important for enabling the optimization and control of highly flexible aero-structures, which are expected to become pervasive in future transportation and energy systems. Indeed, more responsive and deformable aerodynamic surfaces may have transformative impact in efficiency and maneuverability, as demonstrated by the incredible performance of biological flight systems [@Combes:2001;@Birch2001nature;@Hedenstrom2007science;@song2008aeromechanics]. These flexible aero-structures pose a considerable modeling challenge, as they involve highly coupled and nonlinear interactions between the aerodynamic and structural dynamics. A range of aeroelastic modeling methods exist, from high-fidelity models able to simulate the coupled fluid flow fields and the deformation of the wing structure [@peskin2002;@Mittal2005;@Goza2017], to control-oriented data-driven models including viscous and unsteady effects [@Brunton2013_JFM;@Hemati2017;@hickner2021data], and lower-fidelity models such as doublet-lattice methods [@Albano1969], strip theory [@Kim2008], and panel methods [@Murua2012;@fasel2021concurrent;@fonzi2020data]. These methods provide accurate models of aeroelastic effects; however, computationally more efficient models are often necessary for optimization and control, even at the expense of some fidelity. This tradeoff between accuracy and efficiency motivates our work on reduced-order models, which model the behavior of the system with as few states as possible.

![Main features of FlexWing-ROM: (1)  fully parametrized flexible wing model generator, (2) FSI solver coupling a detailed finite element model of the wing structure with a 3D unsteady aerodynamic panel method, and (3) data-driven reduced-order aeroelastic model for (a) single operating condition and (b) interpolating multiple reduced-order models to cover large operating regimes [@fonzi2020data;@iannelli2021balanced].\label{fig:fig1}](Figure1.pdf)

In this work, we present FlexWing-ROM, a matlab code framework that provides three recently developed data-driven reduced-order modeling methods, which extend the dynamic mode decomposition with control (DMDc) [@proctor2016dynamic], and allow modeling highly coupled and nonlinear aeroelasticity over multiple operating regimes. This work is motivated by a particularly compelling application in morphing wings and airborne wind energy [@fasel2017aerostructural;@fasel2021concurrent], although our code implementation is generally applicable to highly coupled aeroelastic systems. The first method implemented in FlexWing-ROM is the algebraic DMDc (aDMDc) [@fonzi2020data]. It extends DMDc for algebraic differential equations (important when considering state trajectories generated by incompressible aerodynamic solvers capturing unsteady effects) and introduces an interpolation scheme smoothly connecting multiple reduced-order models (ROM) valid at different operating conditions. The method allows accurate and computationally efficient prediction of the nonlinearities of the coupled aerostructural-dynamics of flexible wings over large nonlinear flight regimes. The second method is the input-output reduced-order model (IOROM) [@annoni2017method]. The method is closely related to DMDc but considers complete state-space models, also including the output equations. It provides low-order state consistent linear parameter varying models by defining appropriate orthogonal projections. The third method is the balanced mode decomposition (BMD) [@iannelli2021balanced]. The main idea compared to the other two methods is to replace the orthogonal projection onto the proper orthogonal decomposition (POD) modes (as used in DMDc), with a balancing oblique projection constructed from data. This increases the input-output information captured by the reduced-order model. Moreover, the parameter varying projection is state consistent, as one subspace is common to all parameters (providing the state consistent common basis), while the other subspace has no influence on the state’s basis, and can be chosen independently for each parameter.

FlexWing-ROM is a matlab framework applying these three recent data-driven reduced-order modeling methods to flexible wings. The framework also contains a fully parametrized wing model generator and a fluid-structure interaction (FSI) solver. This model generator and solver can also be independently used for analyzing and designing flexible wing structures. The main features of  FlexWing-ROM are shown in figure \autoref{fig:fig1} and the code structure is shown in figure \autoref{fig:fig2}.  


![FlexWing-ROM code structure.\label{fig:fig2}](Figure2.pdf)


# Features

## Fully parametrized wing model generator

The first feature of FlexWing-ROM is a fully parametrized wing model generator that creates a finite element structural model and an unsteady panel method aerodynamic model [@molinari2014aero]. Wing design parameters such as airfoil shape, wing aspect ratio, wing spar and rib design, and material properties can be varied to test different wing designs and compare their performance. In figure \autoref{fig:fig3}, two different examples are shown for a camber morphing NACA6418 wing and a flexible NACA0012 wing. The finite element model generator is using yetAnotherFECode [@jain2020yet] to obtain the mass, damping, and stiffness matrix used in the FSI solver. Flexible wings of interest are mainly made of thin composite plates, therefore, shell elements are used to model the structure [@tiso2006finite]. The aerodynamic model is based on a 3D panel method, with a combination of doublets and sources, and accounts for unsteady aerodynamic effects [@katz2001low].


## Fluid-structure interaction solver

The second feature of the framework is a FSI solver, coupling the structural dynamics and aerodynamics models. The equations of motion that we obtain by the finite element method are numerically integrated using the Newmark method [@newmark1959method]. The unsteady aerodynamic model is integrated using a Runge–Kutta scheme of second order. The aerodynamic forces on the surface are computed with the coefficient of pressure on each panel, considering the far field velocity, the induced velocity by the wing itself, and, to consider unsteady effects, the induced velocity by all the wake panels. The models are coupled via thin plate spline (TPS) [@harder1972interpolation] and inverse distance weighting (IDW) [@shepard1968two] methods. The TPS is used to obtain the deformation of the aerodynamic mesh due to structural deformation, while the IDW is used to project aerodynamic forces onto the structure. A detailed description of the models and the interpolation can be found in [@fasel2019reduced;@fasel2020reduced]. We provide several test cases to compare the different implementations of the FSI, including a comparison of a displacement with a modal based structural model, and a comparison of the unsteady panel method with Theodorsen's function.

![Two different flexible wings are provided in the tutorials: (left) exploded view of a camber morphing NACA6418 wing with five compliant ribs on each side, (right) a flexible NACA0012 wing with only non-morphing stiff ribs.\label{fig:fig3}](Figure3.pdf)


## Data-driven parameter varying reduced-order modeling

The last and main feature is the data-driven model reduction. The FSI solver can be used to generate synthetic impulse response data that is stored in snapshot data files. These are used to build and test the three different reduced-order models. Each method can be used to first generate local linear models that are accurate around a single operating condition. Then, depending on each method, interpolation schemes are introduced to build parameter varying models that are accurate over multiple operating conditions. The accuracy of the method can be evaluated and the different methods can be compared. Importantly, the model order reduction methods can be used with other fluid or fluid structure data sets (both numerical and experimental), by loading any external impulse response data set. Therefore, the code is widely applicable and useful for generating accurate and efficient data-driven reduced-order models. Moreover, the synthetic data generation feature of the code can be used to test new data-driven reduced-order modeling methods, and the three existing methods provide a benchmark for comparing new methods. Finally, FlexWing-ROM includes tutorials that demonstrate the usage of the different features of the framework and enable comparison of the different reduced-order modeling methods. 

# Acknowledgments
This work was supported by the Air Force Office of Scientific Research (AFOSR FA9550-19-1-0386).

# References
